<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="geoGraph">
<title>An introduction to geoGraph • geoGraph</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An introduction to geoGraph">
<meta property="og:description" content="geoGraph">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">geoGraph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/geograph.html">An introduction to geoGraph</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>An introduction to geoGraph</h1>
                        <h4 data-toc-skip class="author">Thibaut Jombart
and Andrea Manica</h4>
            
            <h4 data-toc-skip class="date">2023-12-07</h4>
      
      
      <div class="d-none name"><code>geograph.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="geograph-walking-through-the-geographic-space-using-graphs-">
<em>geoGraph</em>: walking through the geographic space using
graphs.<a class="anchor" aria-label="anchor" href="#geograph-walking-through-the-geographic-space-using-graphs-"></a>
</h2>
<p>This document describes the <em>geoGraph</em> package for the R
software. <em>geoGraph</em> aims at implementing graph approaches for
geographic data. In <em>geoGraph</em>, a given geographic area is
modelled by a fine regular grid, where each vertice has a set of spatial
coordinates and a set of attributes, which can be for instance habitat
descriptors, or the presence/abundance of a given species. ‘Travelling’
within the geographic area can then be easily modelled as moving between
connected vertices. The cost of moving from one vertex to another can be
defined according to attribute values, which allows for instance to
define friction routes based on habitat.</p>
<p><em>geoGraph</em> harnesses the full power of graph algorithms
implemented in R by the <em>graph</em> and <em>RBGL</em> (R Boost Graph
Library) packages. In particular, RBGL is an interface between R and the
comprehensive <em>Boost Graph Library</em> in C++, which provides fast
and efficient implementations of a wide range of graph algorithms. Once
we have defined frictions for an entire geographic area, we can easily,
for instance, find the least costs path from one location to another, or
find the most parsimonious way of connecting a set of locations.</p>
<p>Interfacing spatial data and graphs can be a complicated task. The
purpose of <em>geoGraph</em> is to provide tools to achieve and simplify
this ‘preliminary’ step. This is achieved by defining new classes of
objects which are essentially geo-referenced graphs with node attributes
(<code>gGraph</code> objects), and interfaced spatial data
(<code>gData</code> objects). In this vignette, we show how to install
<em>geoGraph</em>, construct and handle
<code>gGraph</code>/<code>gData</code> objects, and illustrate some
basic features of graph algorithms.</p>
</div>
<div class="section level2">
<h2 id="first-steps">First steps<a class="anchor" aria-label="anchor" href="#first-steps"></a>
</h2>
<div class="section level3">
<h3 id="installing-the-package">Installing the package<a class="anchor" aria-label="anchor" href="#installing-the-package"></a>
</h3>
<p>All the following instructions should be entered from a new R session
to avoid errors due to installing attached packages.</p>
<p><em>devtools</em> is also needed to install <em>geoGraph</em>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span></code></pre></div>
<p>Then, to install <em>geoGraph</em>, simply type:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"thibautjombart/geoGraph"</span><span class="op">)</span></span></code></pre></div>
<p>Once installed, the package can be loaded using:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"geoGraph"</span><span class="op">)</span></span></code></pre></div>
<p>If you have an error regarding missing packages, you may need to
install manually the packages <em>graph</em> and <em>RBGL</em> from
<em>Bioconductor</em>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"graph"</span>, <span class="st">"RBGL"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>And then attempt to reinstall <em>geoGraph</em> from GitHub.</p>
</div>
<div class="section level3">
<h3 id="data-representation">Data representation<a class="anchor" aria-label="anchor" href="#data-representation"></a>
</h3>
<p>Data representation refers to the way a given type of data is handled
by a computer program. Two types of objects are used in
<em>geoGraph</em>: <code>gGraph</code>, and <code>gData</code> objects.
Both objects are defined as formal (S4) classes and often have methods
for similar generic function (e.g. <code>getNodes</code> is defined for
both objects). Essentially, <code>gGraph</code> objects contain
underlying layers of informations, including a spatial grid and possibly
node attributes, and covering the area of interest. <code>gData</code>
are sets of locations (like sampled sites, for instance) which have been
interfaced to a <code>gGraph</code> object, to allow further
manipulations such as finding paths on the grid between pairs of
locations.</p>
<div class="section level4">
<h4 id="ggraph-objects">gGraph objects<a class="anchor" aria-label="anchor" href="#ggraph-objects"></a>
</h4>
<p>The definition of the formal class <code>gGraph</code> can be
obtained using:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/methods/getClass.html" class="external-link">getClass</a></span><span class="op">(</span><span class="st">"gGraph"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Class "gGraph" [package "geoGraph"]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Slots:</span></span>
<span><span class="co">##                                                   </span></span>
<span><span class="co">## Name:      coords nodes.attr       meta      graph</span></span>
<span><span class="co">## Class:     matrix data.frame       list   graphNEL</span></span></code></pre>
<p>and a new empty object can be obtained using the constructor:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"gGraph"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## === gGraph object ===</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @coords: spatial coordinates of 0 nodes</span></span>
<span><span class="co">##      lon lat</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @nodes.attr: 0 nodes attributes</span></span>
<span><span class="co">## data frame with 0 columns and 0 rows</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @meta: list of meta information with 0 items</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @graph:</span></span>
<span><span class="co">## A graphNEL graph with undirected edges</span></span>
<span><span class="co">## Number of Nodes = 0 </span></span>
<span><span class="co">## Number of Edges = 0</span></span></code></pre>
<p>The documentation <code><a href="../reference/gGraph-class.html">?gGraph</a></code> explains the basics about the
object’s content. In a nutshell, these objects are spatial grids with
nodes and segments connecting neighbouring nodes, and additional
informations on the nodes or on the graph itself. <code>coords</code> is
a matrix of longitudes and latitudes of the nodes.
<code>nodes.attr</code> is a data.frame storing attributes of the nodes,
such as habitat descriptors; each row corresponds to a node of the grid,
while each column corresponds to a variable. <code>meta</code> is a list
containing miscellanous informations about the graph itself. There is no
contraint applying to the components of the list, but some typical
components such as <code>$costs</code> or <code>$colors</code> will be
recognised by certain functions. For instance, you can specify plotting
rules for representing a given node attribute by a given color by
defining a component <code>$colors</code>. Similarly, you can associate
costs to a given node attribute by defining a component
<code>$costs</code>. An example of this can be found in already existing
<code>gGraph</code> objects. For instance, <code>worldgraph.10k</code>
is a graph of the world with approximately 10,000 nodes, and only
on-land connectivity
(\textit{i.e.<code>no travelling on the seas).  ```{r } worldgraph.10k worldgraph.10k@meta ``` Lastly, the</code>graph<code>component is a</code>graphNEL`
object, which is the standard class for graphs in the <em>graph</em> and
<em>RBGL</em> packages. This object contains all information on the
connections between nodes, and the weights (costs) of these
connections.</p>
<p>Four main <code>gGraph</code> are provided with <em>geoGraph</em>:
<code>rawgraph.10k</code>, <code>rawgraph.40k</code>,
<code>worldgraph.10k</code>, and <code>worldgraph.40k</code>. These
datasets are available using the command <code>data</code>. The grid
used in these datasets are the best geometric approximation of a regular
grid for the surface of a sphere. One advantage of working with these
grids is that we do not have to use a projection for geographic
coordinates, which is a usual issue in regular GIS.</p>
<p>The difference between rawgraphs and worldgraphs is that the first
are entirely connected, while in the second connections occur only on
land. Numbers <code>10k' and</code>40k’ indicate that the grids consist
of roughly 10,000 and 40,000 nodes. For illustrative purposes, we will
often use the 10k grids, since they are less heavy to handle. For most
large-scale applications, the 40k versions should provide sufficient
resolution. New <code>gGraph</code> can be constructed using the
constructor (<code>new(...)</code>), but this topic is not documented in
this vignette.</p>
</div>
<div class="section level4">
<h4 id="gdata-objects">gData objects<a class="anchor" aria-label="anchor" href="#gdata-objects"></a>
</h4>
<p><code>gData</code> are essentially sets of locations that are
interfaced with a <code>gGraph</code> object. During this operation,
each location is assigned to the closest node on the grid of the
<code>gGraph</code>, then allowing for travelling between locations
using the grid. Then, it is for instance possible to find the shortest
path between two locations through various types of habitats.</p>
<p>Like for <code>gGraph</code>, the content of the formal class
<code>gData</code> can be obtained using:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/methods/getClass.html" class="external-link">getClass</a></span><span class="op">(</span><span class="st">"gData"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Class "gData" [package "geoGraph"]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Slots:</span></span>
<span><span class="co">##                                                       </span></span>
<span><span class="co">## Name:       coords    nodes.id        data gGraph.name</span></span>
<span><span class="co">## Class:      matrix   character         ANY   character</span></span></code></pre>
<p>and a new empty object can be obtained using the constructor:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"gData"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## === gData object ===</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @coords: spatial coordinates of 0 nodes</span></span>
<span><span class="co">##      lon lat</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @nodes.id: nodes identifiers</span></span>
<span><span class="co">## character(0)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @data: data</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Associated gGraph:</span></span></code></pre>
<p>As before, the description of the content of these objects can be
found in the documentation (<code><a href="../reference/gData-class.html">?gData</a></code>). <code>coords</code> is
a matrix of xy (longitude/latitude) coordinates in which each row is a
location. <code>nodes.id</code> is vector of characters giving the name
of the vertices matching the locations; this is defined automatically
when creating a new <code>gData</code>, or using the function
<code>closestNode</code>. <code>data</code> is a slot storing data
associated to the locations; it can be any type of object, but a
data.frame should cover most requirements for storing data. Note that
this object should be subsettable (i.e. the <code>[</code> operator
should be defined), so that data can be subsetted when subsetting the
<code>gData</code> object. Lastly, the slot <code>gGraph.name</code>
contains the name of the <code>gGraph</code> object to which the
<code>gData</code> has been interfaced.</p>
<p>Contrary to <code>gGraph</code> objects, <code>gData</code> objects
will frequently be constructed by the user. In the next sections, we
illustrate how we can build and use <code>gData</code> objects from a
set of locations.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="using-geograph">Using <em>geoGraph</em><a class="anchor" aria-label="anchor" href="#using-geograph"></a>
</h2>
<p>An overview of the material implemented in the package is summarized
the package’s manpage, accessible via:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">geoGraph</span></span></code></pre></div>
<p>The html version of this manpage may be preferred to browse more
easily the content of <em>geoGraph</em>; it is accessible by typing:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="st">"geoGraph"</span>, package <span class="op">=</span> <span class="st">"geoGraph"</span>, html <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>To revert help back to text mode, simply type:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>htmlhelp <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>In the following, we go through various tasks that can be achieve
using <em>geoGraph</em>.</p>
<div class="section level3">
<h3 id="importing-geographic-data">Importing geographic data<a class="anchor" aria-label="anchor" href="#importing-geographic-data"></a>
</h3>
<p>GeoGraphic data consist of a set of locations, possibly accompanied
by additional information. For instance, one may want to study the
migrations amongst a set of biological populations with known geographic
coordinates. In <em>geoGraph</em>, geographic data are stored in
<code>gData</code> objects. These objects match locations to the closest
nodes on a grid (a <code>gGraph</code> object), and store additional
data if needed.</p>
<p>As a toy example, let us consider four locations: Bordeaux (France),
London (UK), Malaga (Spain), and Zagreb (Croatia). Since we will be
working with a crude grid (10,000 nodes), locations need not be exact.
We enter the longitudes and latitudes (in this order, that is, xy
coordinates) of these cities in decimal degrees, as well as approximate
population sizes:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Bordeaux</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">45</span><span class="op">)</span></span>
<span><span class="va">London</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">51</span><span class="op">)</span></span>
<span><span class="va">Malaga</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">37</span><span class="op">)</span></span>
<span><span class="va">Zagreb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">46</span><span class="op">)</span></span>
<span><span class="va">cities.dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind.data.frame</a></span><span class="op">(</span><span class="va">Bordeaux</span>, <span class="va">London</span>, <span class="va">Malaga</span>, <span class="va">Zagreb</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cities.dat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lon"</span>, <span class="st">"lat"</span><span class="op">)</span></span>
<span><span class="va">cities.dat</span><span class="op">$</span><span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e6</span>, <span class="fl">13e6</span>, <span class="fl">5e5</span>, <span class="fl">1.2e6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">cities.dat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bordeaux"</span>, <span class="st">"London"</span>, <span class="st">"Malaga"</span>, <span class="st">"Zagreb"</span><span class="op">)</span></span>
<span><span class="va">cities.dat</span></span></code></pre></div>
<pre><code><span><span class="co">##          lon lat     pop</span></span>
<span><span class="co">## Bordeaux  -1  45 1.0e+06</span></span>
<span><span class="co">## London     0  51 1.3e+07</span></span>
<span><span class="co">## Malaga    -4  37 5.0e+05</span></span>
<span><span class="co">## Zagreb    16  46 1.2e+06</span></span></code></pre>
<p>We load a <code>gGraph</code> object which contains the grid that
will support the data:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">worldgraph.10k</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## === gGraph object ===</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @coords: spatial coordinates of 10242 nodes</span></span>
<span><span class="co">##       lon    lat</span></span>
<span><span class="co">## 1 -180.00  90.00</span></span>
<span><span class="co">## 2  144.00 -90.00</span></span>
<span><span class="co">## 3  -33.78  27.19</span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @nodes.attr: 1 nodes attributes</span></span>
<span><span class="co">##   habitat</span></span>
<span><span class="co">## 1     sea</span></span>
<span><span class="co">## 2     sea</span></span>
<span><span class="co">## 3     sea</span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @meta: list of meta information with 2 items</span></span>
<span><span class="co">## [1] "$colors" "$costs" </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @graph:</span></span>
<span><span class="co">## A graphNEL graph with undirected edges</span></span>
<span><span class="co">## Number of Nodes = 10242 </span></span>
<span><span class="co">## Number of Edges = 6954</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">worldgraph.10k</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/wg10plot-1.png" width="768"></p>
<p>(we could use <code>worldgraph.40k</code> for a better resolution).
In this figure, each node is represented with a color depending on the
habitat type, either ‘sea’ (blue) or ‘land’ (green). We are going to
interface the cities data with this grid; to do so, we create a
<code>gData</code> object using <code>new</code> (see
<code><a href="../reference/gData-class.html">?gData</a></code> object):</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"gData"</span>, coords <span class="op">=</span> <span class="va">cities.dat</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, data <span class="op">=</span> <span class="va">cities.dat</span><span class="op">[</span>, <span class="fl">3</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, gGraph.name <span class="op">=</span> <span class="st">"worldgraph.10k"</span><span class="op">)</span></span>
<span><span class="va">cities</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## === gData object ===</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @coords: spatial coordinates of 4 nodes</span></span>
<span><span class="co">##   lon lat</span></span>
<span><span class="co">## 1  -1  45</span></span>
<span><span class="co">## 2   0  51</span></span>
<span><span class="co">## 3  -4  37</span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @nodes.id: nodes identifiers</span></span>
<span><span class="co">##      1      2      3 </span></span>
<span><span class="co">## "5774" "6413" "4815" </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @data: 4 data</span></span>
<span><span class="co">##              pop</span></span>
<span><span class="co">## Bordeaux 1.0e+06</span></span>
<span><span class="co">## London   1.3e+07</span></span>
<span><span class="co">## Malaga   5.0e+05</span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Associated gGraph: worldgraph.10k</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cities</span>, type <span class="op">=</span> <span class="st">"both"</span>, reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot-gGraph.html">plotEdges</a></span><span class="op">(</span><span class="va">worldgraph.10k</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/citiesplot-1.png" width="700"></p>
<p>This figure illustrates the matching of original locations (black
crosses) to nodes of the grid (red circles). As we can see, an issue
occured for Bordeaux, which has been assigned to a node in the sea (in
blue). Locations can be re-assigned to nodes with restrictions for some
node attribute values using <code>closestNode</code>; for instance, here
we constrain matching nodes to have an <code>habitat</code> value
(defined as node attribute in <code>worldgraph.10k</code>) equalling
<code>land</code> (green points):</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cities</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/closestNode.html">closestNode</a></span><span class="op">(</span><span class="va">cities</span>, attr.name <span class="op">=</span> <span class="st">"habitat"</span>, attr.value <span class="op">=</span> <span class="st">"land"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cities</span>, type <span class="op">=</span> <span class="st">"both"</span>, reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot-gGraph.html">plotEdges</a></span><span class="op">(</span><span class="va">worldgraph.10k</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/closeNode-1.png" width="700"></p>
<p>Now, all cities have been assigned to a
<code>land' node of the grid (again, better accuracy will be gained on 40k or finer grids - we use 10k for illustrative purposes only). Content of</code>cities<code>can be accessed via various accessors (see</code>?gData`).
For instance, we can retrieve original locations, assigned nodes, and
stored data using:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gGraph-class.html">getCoords</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      lon lat</span></span>
<span><span class="co">## 5775  -1  45</span></span>
<span><span class="co">## 6413   0  51</span></span>
<span><span class="co">## 4815  -4  37</span></span>
<span><span class="co">## 7699  16  46</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gGraph-class.html">getNodes</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   5774   6413   4815   7699 </span></span>
<span><span class="co">## "5775" "6413" "4815" "7699"</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gData-class.html">getData</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##              pop</span></span>
<span><span class="co">## Bordeaux 1.0e+06</span></span>
<span><span class="co">## London   1.3e+07</span></span>
<span><span class="co">## Malaga   5.0e+05</span></span>
<span><span class="co">## Zagreb   1.2e+06</span></span></code></pre>
<p>We can also get the coordinates of the matching nodes (, red circle
on previous figure) using:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gGraph-class.html">getCoords</a></span><span class="op">(</span><span class="va">cities</span>, original <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             lon   lat</span></span>
<span><span class="co">## 5775  1.002e-05 43.73</span></span>
<span><span class="co">## 6413  1.002e-05 51.38</span></span>
<span><span class="co">## 4815 -3.788e+00 37.75</span></span>
<span><span class="co">## 7699  1.548e+01 46.74</span></span></code></pre>
<p>More interestingly, we can now retrieve all the geographic
information contained in the underlying grid (, <code>gGraph</code>
object) as node attributes:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getNodesAttr.html">getNodesAttr</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      habitat</span></span>
<span><span class="co">## 5775    land</span></span>
<span><span class="co">## 6413    land</span></span>
<span><span class="co">## 4815    land</span></span>
<span><span class="co">## 7699    land</span></span></code></pre>
<p>In this example, the information stored in
<code>worldgraph.10k</code> is rather crude: <code>habitat</code> only
distinguishes the land from the sea. However, more complex habitat
information could be incorporated, for instance from GIS shapefiles (see
dedicated section below).</p>
</div>
<div class="section level3">
<h3 id="visualizing-data">Visualizing data<a class="anchor" aria-label="anchor" href="#visualizing-data"></a>
</h3>
<p>An essential aspect of spatial analysis lies in visualizing the data.
In <em>geoGraph</em>, the spatial grids (<code>gGraph</code>) and
spatial data (<code>gData</code>) can be plotted and browsed using a
variety of functions.</p>
<div class="section level4">
<h4 id="plotting-ggraph-objects">Plotting <code>gGraph</code> objects<a class="anchor" aria-label="anchor" href="#plotting-ggraph-objects"></a>
</h4>
<p>Displaying a <code>gGraph</code> object is done through
<code>plot</code> and <code>points</code> functions. The first opens a
new plotting region, while the second draws in the current plotting
region; functions have otherwise similar arguments (see
<code><a href="../reference/plot-gGraph.html">?plot.gGraph</a></code>).</p>
<p>By default, plotting a <code>gGraph</code> displays the grid of nodes
overlaying a shapefile (by default, the landmasses). Edges can be
plotted at the same time (argument <code>edges</code>), or added
afterwards using <code>plotEdges</code>. If the <code>gGraph</code>
object possesses an adequately formed <code>meta$colors</code>
component, the colors of the nodes are chosen according to the node
attributes and the color scheme specified in <code>meta$colors</code>.
Alternatively, the color of the nodes can be specified via the
<code>col</code> argument in <code>plot</code>/<code>points</code>.</p>
<p>Here is an example using <code>worldgraph.10k</code>:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">worldgraph.10k</span><span class="op">@</span><span class="va">meta</span><span class="op">$</span><span class="va">colors</span></span></code></pre></div>
<pre><code><span><span class="co">##            habitat       color</span></span>
<span><span class="co">## 1              sea        blue</span></span>
<span><span class="co">## 2             land       green</span></span>
<span><span class="co">## 3         mountain       brown</span></span>
<span><span class="co">## 4       landbridge light green</span></span>
<span><span class="co">## 5 oceanic crossing  light blue</span></span>
<span><span class="co">## 6  deselected land   lightgray</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/getNodesAttr.html">getNodesAttr</a></span><span class="op">(</span><span class="va">worldgraph.10k</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   habitat</span></span>
<span><span class="co">## 1     sea</span></span>
<span><span class="co">## 2     sea</span></span>
<span><span class="co">## 3     sea</span></span>
<span><span class="co">## 4     sea</span></span>
<span><span class="co">## 5     sea</span></span>
<span><span class="co">## 6     sea</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/getNodesAttr.html">getNodesAttr</a></span><span class="op">(</span><span class="va">worldgraph.10k</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## habitat</span></span>
<span><span class="co">## deselected land            land             sea </span></span>
<span><span class="co">##             290            2632            7320</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">worldgraph.10k</span>, reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Default plotting of worldgraph.10k"</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/wg10kdefplot-1.png" width="768"></p>
<p>It may be worth noting that plotting <code>gGraph</code> objects
involves plotting a fairly large number of points and edges. On some
graphical devices, the resulting plotting can be slow. For instance, one
may want to disable <code>cairo</code> under linux: this graphical
device yields better graphics than <code>Xlib</code>, but at the expense
of increase computational time. To switch to <code>Xlib</code>,
type:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/x11.html" class="external-link">X11.options</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"Xlib"</span><span class="op">)</span></span></code></pre></div>
<p>and to revert to <code>cairo</code>, type:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/x11.html" class="external-link">X11.options</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"cairo"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="zooming-in-and-out-sliding-etc-">Zooming in and out, sliding, etc.<a class="anchor" aria-label="anchor" href="#zooming-in-and-out-sliding-etc-"></a>
</h4>
<p>In practice, it is often useful to be able to peer at specific
regions, and more generally to navigate inside the graphical
representation of the data. For this, we can use the interactive
functions <code>geo.zoomin</code>, <code>geo.zoomout</code>,
<code>geo.slide</code>, <code>geo.back</code>,
<code>geo.bookmark</code>, and <code>geo.goto</code>. The zoom and slide
functions require to left-click on the graphics to zoom in, zoom out, or
slide to adjacent areas; in all cases, a right click ends the function.
Also note that <code>geo.zoomin</code> can accept an argument specifying
a rectangular region, which will be adapted by the function to fit best
a square area with similar position and centre, and zoom to this area
(see <code><a href="../reference/zoom.html">?geo.zoomin</a></code>). <code>geo.bookmark</code> and
<code>geo.goto</code> respectively set and go to a bookmark,
<em>i.e.</em> a tagged area. This is most useful when one has to switch
between distant areas repeatedly.</p>
<p>Here are some examples based on the previous plotting of
<code>worldgraph.10k</code>: Zooming in:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/zoom.html">geo.zoomin</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/zoomin-1.png" width="700"></p>
<p>Zooming out:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/zoom.html">geo.zoomout</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/zoomout-1.png" width="700"></p>
<p>Sliding to the east:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/zoom.html">geo.slide</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/geoslide-1.png" width="700"></p>
<p>One important thing which makes plotting <code>gGraph</code> objects
different from most other plotting in R is that <code>geoGraph</code>
keeps the changes made to the plotting area in memory. This allows to
undo one or several moves using <code>geo.back</code>. Moreover, even if
the graphical device is killed, plotting again a <code>gGraph</code>
will use the old parameters by default. To disable this behavior, set
the argument <code>reset=TRUE</code> when calling upon
<code>plot</code>. Technically, this ‘plotting memory’ is implemented by
storing plotting information in an environment defined as the hidden
environment <code>geoGraph:::.geoGraphEnv</code>:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span>env <span class="op">=</span> <span class="fu">geoGraph</span><span class="fu">:::</span><span class="va">.geoGraphEnv</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "bookmarks"       "last.plot"       "last.plot.param" "last.points"    </span></span>
<span><span class="co">## [5] "psize"           "sticky.points"   "usr"             "zoom.log"</span></span></code></pre>
<p>You can inspect individual variables within this environment:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="st">"last.plot.param"</span>, envir <span class="op">=</span> <span class="fu">geoGraph</span><span class="fu">:::</span><span class="va">.geoGraphEnv</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $psize</span></span>
<span><span class="co">## [1] 0.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $pch</span></span>
<span><span class="co">## [1] 19</span></span></code></pre>
<p>However, it is recommended not to modify these objects directly,
unless you really know what you are doing. In any case, plotting a
<code>gGraph</code> object with argument <code>reset=TRUE</code> will
remove previous plotting history and undo possible wrong
manipulations.</p>
</div>
<div class="section level4">
<h4 id="plotting-gdata-objects">Plotting <code>gData</code> objects<a class="anchor" aria-label="anchor" href="#plotting-gdata-objects"></a>
</h4>
<p><code>gData</code> objects are by default plotted overlaying the
corresponding <code>gGraph</code>. For instance, using the
<code>cities</code> example from above:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cities</span>, reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fu"><a href="../reference/gGraph-class.html">getCoords</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="../reference/gData-class.html">getData</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/citiesPlot2-1.png" width="700"></p>
<p>Note the argument <code>reset=TRUE</code>, which tells the plotting
function to adapt the plotting area to the geographic extent of the
dataset.</p>
<p>To plot additional information, it can be useful to extract the
spatial coordinates from the data. This is achieved by
<code>getCoords</code>. This method takes an extra argument
<code>original</code>, which is TRUE if original spatial coordinates are
seeked, or FALSE for coordinates of the nodes on the grid. We can use
this to represent, for instance, the population sizes for the different
cities:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">transp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">col</span>, <span class="va">alpha</span> <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/col2rgb.html" class="external-link">col2rgb</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">c</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="va">c</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fl">255</span>, <span class="va">c</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="fl">255</span>, <span class="va">c</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fl">255</span>, <span class="va">alpha</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cities</span>, reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>xpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fu"><a href="../reference/gGraph-class.html">getCoords</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span> <span class="op">+</span> <span class="op">-</span><span class="fl">.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="../reference/gData-class.html">getData</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/symbols.html" class="external-link">symbols</a></span><span class="op">(</span><span class="fu"><a href="../reference/gGraph-class.html">getCoords</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="../reference/gGraph-class.html">getCoords</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, circ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="../reference/gData-class.html">getData</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, inch <span class="op">=</span> <span class="fl">.2</span>, bg <span class="op">=</span> <span class="fu">transp</span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/cities_plot-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="editing-ggraphs">Editing <code>gGraphs</code><a class="anchor" aria-label="anchor" href="#editing-ggraphs"></a>
</h3>
<p>Editing graphs is an essential task in <em>geoGraph</em>. While
available <code>gGraph</code> objects provide a basis to work with (see
<code><a href="../reference/worldgraph.html">?worldgraph.10k</a></code>), one may want to adapt a graph to a
specific case. For instance, connectivity should be defined according to
biological knowledge of the organism under study. <code>gGraph</code>
can be modified in different ways: by changing the connectivity, the
costs of edges, or the attribute values.</p>
<div class="section level4">
<h4 id="changing-the-global-connectivity-of-a-ggraph">Changing the global connectivity of a <code>gGraph</code><a class="anchor" aria-label="anchor" href="#changing-the-global-connectivity-of-a-ggraph"></a>
</h4>
<p>There are two main ways of changing the connectivity of a
<code>gGraph</code>, which match two different objectives. The first
approach is to perform global and systematic changes of the connectivity
of the graph. Typically, one will want to remove all connections over a
given type of landscape, which is uncrossable by the organism under
study. Let’s assume we are interested in saltwater fishes. To model fish
dispersal, we have to define a graph which connects only nodes
overlaying the sea. We load the <code>gGraph</code> object
<code>rawgraph.10k</code>, and zoom in to a smaller area (Madagascar) to
illustrate changes in connectivity:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/zoom.html">geo.zoomin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35</span>, <span class="fl">54</span>, <span class="op">-</span><span class="fl">26</span>, <span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot-gGraph.html">plotEdges</a></span><span class="op">(</span><span class="va">rawgraph.10k</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/plot_edges-1.png" width="700"></p>
<p>We shall set a bookmark for this area, in case we would want to get
back to this place later on:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/zoom.html">geo.bookmark</a></span><span class="op">(</span><span class="st">"madagascar"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Bookmark ' madagascar  'saved.</span></span></code></pre>
<p>What we now want to do is remove all but sea-sea connections. To do
so, the easiest approach is to i) define costs for the edges based on
habitat, with land being given large costs and ii) remove all edges with
large costs.</p>
<p>Costs of a given node attribute (here,
<code>habitat') are indicated in the</code>meta$costs` slot:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rawgraph.10k</span><span class="op">@</span><span class="va">meta</span><span class="op">$</span><span class="va">costs</span></span></code></pre></div>
<pre><code><span><span class="co">##            habitat cost</span></span>
<span><span class="co">## 1              sea  100</span></span>
<span><span class="co">## 2             land    1</span></span>
<span><span class="co">## 3         mountain   10</span></span>
<span><span class="co">## 4       landbridge    5</span></span>
<span><span class="co">## 5 oceanic crossing   20</span></span>
<span><span class="co">## 6  deselected land  100</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newGraph</span> <span class="op">&lt;-</span> <span class="va">rawgraph.10k</span></span>
<span><span class="va">newGraph</span><span class="op">@</span><span class="va">meta</span><span class="op">$</span><span class="va">costs</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">newGraph</span><span class="op">@</span><span class="va">meta</span><span class="op">$</span><span class="va">costs</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">newGraph</span><span class="op">@</span><span class="va">meta</span><span class="op">$</span><span class="va">costs</span></span></code></pre></div>
<pre><code><span><span class="co">##            habitat cost</span></span>
<span><span class="co">## 1              sea    1</span></span>
<span><span class="co">## 2             land  100</span></span>
<span><span class="co">## 3         mountain  100</span></span>
<span><span class="co">## 4       landbridge  100</span></span>
<span><span class="co">## 5 oceanic crossing  100</span></span>
<span><span class="co">## 6  deselected land  100</span></span></code></pre>
<p>We have just changed the costs associated to habitat type, but this
change is not yet effective on edges between nodes. We use
<code>setCosts</code> to set the cost of an edge to the average of the
costs of its nodes:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newGraph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setCosts.html">setCosts</a></span><span class="op">(</span><span class="va">newGraph</span>, attr.name <span class="op">=</span> <span class="st">"habitat"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">newGraph</span>, edge <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/unnamed-chunk-23-1.png" width="768"></p>
<p>On this new graph, we represent the edges with a width inversely
proportional to the associated cost; that is, bold lines for easy
travelling and light edges/dotted lines for more costly mouvement. This
is not enough yet, since travelling on land is still possible. However,
we can tell <em>geoGraph</em> to remove all edges associated to too
strong a cost, as defined by a given threshold (using
<code>dropDeadEdges</code>). Here, only sea-sea connections shall be
retained, that is, edges with cost 1.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newGraph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dropDeadEdges.html">dropDeadEdges</a></span><span class="op">(</span><span class="va">newGraph</span>, thres <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">newGraph</span>, edge <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>Here we are: <code>newGraph</code> only contains connections in the
sea. Note that, although we restrained the plotting area to Madagascar,
this change is effective everywhere. For instance, travelling to the
nort-west Australian coasts:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/zoom.html">geo.zoomin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">110</span>, <span class="fl">130</span>, <span class="op">-</span><span class="fl">27</span>, <span class="op">-</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/bookmark-1.png" width="700"></p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/zoom.html">geo.bookmark</a></span><span class="op">(</span><span class="st">"australia"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Bookmark ' australia  'saved.</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="changing-local-properties-of-a-ggraph">Changing local properties of a <code>gGraph</code><a class="anchor" aria-label="anchor" href="#changing-local-properties-of-a-ggraph"></a>
</h4>
<p>A second approach to changing a <code>gGraph</code> is to refine the
graph by hand, adding or removing locally some connections, or altering
the attributes of some nodes. This can be necessary to connect
components such as islands to the main landmasses, or to correct
erroneous data. Adding and removing edges from the grid of a
<code>gGraph</code> can be achieved by <code>geo.add.edges</code> and
<code>geo.remove.edges</code>, respectively. These functions are
interactive, and require the user to select individual nodes or a
rectangular area in which edges are added or removed. See
<code><a href="../reference/geo.add.edges.html">?geo.add.edges</a></code> for more information on these functions. For
instance, we can remove a few odd connections in the previous graph,
near the Australian coasts (note that we have to save the changes using
<code>&lt;-</code>):</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/zoom.html">geo.goto</a></span><span class="op">(</span><span class="st">"australia"</span><span class="op">)</span></span>
<span><span class="va">newGraph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geo.add.edges.html">geo.remove.edges</a></span><span class="op">(</span><span class="va">newGraph</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figs/georemove.png" alt=""><p class="caption">img</p>
</div>
<p>When adding connections within an area or in an entire graph, node
addition is based on another <code>gGraph</code>,<em>i.e.</em> only
connections existing in another <code>gGraph</code> serving as reference
can be added to the current <code>gGraph</code>. For graphs based on 10k
or 40k grids, the raw graphs provided in <code>geoGraph</code> should be
used, (<code>rawgraph.10k</code>, <code>rawgraph.40k</code>), since they
are fully connected.</p>
<p>In addition to changing grid connectivity, we may also want to modify
the attributes of specific nodes. This is again done interactively,
using the function <code>geo.change.attr</code>. For instance, here, we
define a new value <code>shalowwater</code> (plotted in light blue) for
the attribute <code>habitat</code>, selecting affected nodes using the
‘area’ mode first, and refining the changes using the ‘point’ mode:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">newGraph</span>, edge <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geo.change.attr.html">geo.change.attr</a></span><span class="op">(</span><span class="va">newGraph</span>, mode <span class="op">=</span> <span class="st">"area"</span>, attr.name <span class="op">=</span> <span class="st">"habitat"</span>, attr.value <span class="op">=</span> <span class="st">"shallowwater"</span>, newCol <span class="op">=</span> <span class="st">"deepskyblue"</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geo.change.attr.html">geo.change.attr</a></span><span class="op">(</span><span class="va">temp</span>, attr.name <span class="op">=</span> <span class="st">"habitat"</span>, attr.value <span class="op">=</span> <span class="st">"shallowwater"</span>, newCol <span class="op">=</span> <span class="st">"deepskyblue"</span><span class="op">)</span></span>
<span><span class="va">newGraph</span> <span class="op">&lt;-</span> <span class="va">temp</span></span></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newGraph</span><span class="op">@</span><span class="va">meta</span><span class="op">$</span><span class="va">colors</span></span></code></pre></div>
<pre><code><span><span class="co">##            habitat       color</span></span>
<span><span class="co">## 1              sea        blue</span></span>
<span><span class="co">## 2             land       green</span></span>
<span><span class="co">## 3         mountain       brown</span></span>
<span><span class="co">## 4       landbridge light green</span></span>
<span><span class="co">## 5 oceanic crossing  light blue</span></span>
<span><span class="co">## 6  deselected land   lightgray</span></span>
<span><span class="co">## 7     shallowwater deepskyblue</span></span></code></pre>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">newGraph</span>, edge <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<p>Again, note that the changes made to the graph have to be save in an
object (using <code>&lt;-</code>) to be effective.</p>
</div>
</div>
<div class="section level3">
<h3 id="extracting-information-from-gis-shapefiles">Extracting information from GIS shapefiles<a class="anchor" aria-label="anchor" href="#extracting-information-from-gis-shapefiles"></a>
</h3>
<p>An important feature of <em>geoGraph</em> is serving as an interface
between <em>geographic information system</em> (GIS) layers and
geographic data. As currently implemented, <em>geoGraph</em> can extract
information from shapefiles with the Arc GIS (<a href="http://www.esri.com/software/arcgis/index.html" class="external-link uri">http://www.esri.com/software/arcgis/index.html</a>) format,
using the function <code>extractFromLayer</code>. Here, we illustrate
this procedure using the shapefile <code>world-countries.shp</code>
provided with the package. <em>geoGraph</em> still relies on
<code>SpatialPolygonDataFrame</code> objects from the <code>sp</code>
package. A move to <code>sf</code> objects is planned, but for the
moment we have to use <code><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">sf::st_read()</a></code> to read a GIS shapefile
into an <code>sf</code> object, and then cast it to a
<code>SpatialPolygonDataFrame</code> with
<code><a href="https://r-spatial.github.io/sf/reference/coerce-methods.html" class="external-link">sf::as_Spatial()</a></code>:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span></span></code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">world.countries</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"files/shapefiles/world-countries.shp"</span>, package <span class="op">=</span> <span class="st">"geoGraph"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Reading layer `world-countries' from data source </span></span>
<span><span class="co">##   `/home/runner/work/_temp/Library/geoGraph/files/shapefiles/world-countries.shp' </span></span>
<span><span class="co">##   using driver `ESRI Shapefile'</span></span>
<span><span class="co">## Simple feature collection with 239 features and 8 fields</span></span>
<span><span class="co">## Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -180 ymin: -89.9 xmax: 181.8 ymax: 84.93</span></span>
<span><span class="co">## CRS:           NA</span></span></code></pre>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">world.countries</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/coerce-methods.html" class="external-link">as_Spatial</a></span><span class="op">(</span><span class="va">world.countries</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">world.countries</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "SpatialPolygonsDataFrame"</span></span>
<span><span class="co">## attr(,"package")</span></span>
<span><span class="co">## [1] "sp"</span></span></code></pre>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">world.countries</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                   Length                    Class                     Mode </span></span>
<span><span class="co">##                      239 SpatialPolygonsDataFrame                       S4</span></span></code></pre>
<p>The summary of <code>world.countries</code> shows the data
(attributes) stored in the layer. Let us assume that we are interested
in retrieving continent and country information for the
<code>worldgraph.10k</code> object. Note that
<code>extractFromLayer</code> can extract information to other types of
objects than <code>gGraph</code> (see
<code><a href="../reference/extractFromLayer.html">?extractFromLayer</a></code>)</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/getNodesAttr.html">getNodesAttr</a></span><span class="op">(</span><span class="va">worldgraph.10k</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             habitat    </span></span>
<span><span class="co">##  deselected land: 290  </span></span>
<span><span class="co">##  land           :2632  </span></span>
<span><span class="co">##  sea            :7320</span></span></code></pre>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newGraph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extractFromLayer.html">extractFromLayer</a></span><span class="op">(</span><span class="va">worldgraph.10k</span>, layer <span class="op">=</span> <span class="va">world.countries</span>, attr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CONTINENT"</span>, <span class="st">"NAME"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/getNodesAttr.html">getNodesAttr</a></span><span class="op">(</span><span class="va">newGraph</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             habitat      CONTINENT             NAME          </span></span>
<span><span class="co">##  deselected land: 290   Length:10242       Length:10242      </span></span>
<span><span class="co">##  land           :2632   Class :character   Class :character  </span></span>
<span><span class="co">##  sea            :7320   Mode  :character   Mode  :character</span></span></code></pre>
<p>The new object <code>newGraph</code> is a <code>gGraph</code> which
now includes, for each node of the grid, the corresponding continent and
country retrieved from the GIS layer. We can use the newly acquired
information for plotting <code>newGraph</code>, by defining new color
rules:</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="../reference/getNodesAttr.html">getNodesAttr</a></span><span class="op">(</span><span class="va">newGraph</span><span class="op">)</span><span class="op">$</span><span class="st">"NAME"</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"transparent"</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">colMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>NAME <span class="op">=</span> <span class="va">temp</span>, color <span class="op">=</span> <span class="va">col</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">colMat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           NAME       color</span></span>
<span><span class="co">## 1         &lt;NA&gt; transparent</span></span>
<span><span class="co">## 2    Antartica     #FF0000</span></span>
<span><span class="co">## 3 Saudi Arabia     #FF0B00</span></span>
<span><span class="co">## 4        Yemen     #FF1500</span></span>
<span><span class="co">## 5      Somalia     #FF2000</span></span>
<span><span class="co">## 6        China     #FF2B00</span></span></code></pre>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">colMat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           NAME   color</span></span>
<span><span class="co">## 140     Latvia #FF0040</span></span>
<span><span class="co">## 141    Belarus #FF0035</span></span>
<span><span class="co">## 142    Eritrea #FF002A</span></span>
<span><span class="co">## 143   Djibouti #FF0020</span></span>
<span><span class="co">## 144 East Timor #FF0015</span></span>
<span><span class="co">## 145     Jordan #FF000B</span></span></code></pre>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">newGraph</span>, col.rules <span class="op">=</span> <span class="va">colMat</span>, reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
<p>This information could in turn be used to define costs for travelling
on the grid. For instance, one could import habitat descriptors from a
GIS, use these values to formulate a habitat model, and derive costs for
dispersal on the grid.</p>
<p>As soon as a GIS layer has been extracted to a <code>gGraph</code>,
this information becomes also available for any <code>gData</code>
interfaced with this object. For instance, we can re-use the
<code>cities</code> example defined in a previous section, and interface
it with <code>newGraph</code> to retrieve continent and country
information for the cities of the dataset:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cities.dat</span></span></code></pre></div>
<pre><code><span><span class="co">##          lon lat     pop</span></span>
<span><span class="co">## Bordeaux  -1  45 1.0e+06</span></span>
<span><span class="co">## London     0  51 1.3e+07</span></span>
<span><span class="co">## Malaga    -4  37 5.0e+05</span></span>
<span><span class="co">## Zagreb    16  46 1.2e+06</span></span></code></pre>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"gData"</span>, coords <span class="op">=</span> <span class="va">cities.dat</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, data <span class="op">=</span> <span class="va">cities.dat</span><span class="op">[</span>, <span class="fl">3</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, gGraph.name <span class="op">=</span> <span class="st">"newGraph"</span><span class="op">)</span></span>
<span><span class="va">cities</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/closestNode.html">closestNode</a></span><span class="op">(</span><span class="va">cities</span>, attr.name <span class="op">=</span> <span class="st">"habitat"</span>, attr.value <span class="op">=</span> <span class="st">"land"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gData-class.html">getData</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##              pop</span></span>
<span><span class="co">## Bordeaux 1.0e+06</span></span>
<span><span class="co">## London   1.3e+07</span></span>
<span><span class="co">## Malaga   5.0e+05</span></span>
<span><span class="co">## Zagreb   1.2e+06</span></span></code></pre>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getNodesAttr.html">getNodesAttr</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      habitat CONTINENT                 NAME</span></span>
<span><span class="co">## 5775    land    Europe France, Metropolitan</span></span>
<span><span class="co">## 6413    land    Europe       United Kingdom</span></span>
<span><span class="co">## 4815    land    Europe                Spain</span></span>
<span><span class="co">## 7699    land    Europe              Austria</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="finding-least-cost-paths">Finding least-cost paths<a class="anchor" aria-label="anchor" href="#finding-least-cost-paths"></a>
</h3>
<p>One of the most useful applications of <em>geoGraph</em> is the
research of least-cost paths between couples of locations. This can be
achieved using the functions <code>dijkstraFrom</code> and
<code>dijkstraBetween</code> on a <code>gData</code> object which
contains all the locations of interest. These functions return
least-cost paths with the format <code>gPath</code>.
<code>dijkstraFrom</code> compute the paths from a given node of the
grid to all locations of the <code>gData</code>, while
<code>dijkstraBetween</code> computes the paths between pairs of
locations of the <code>gData</code>. Below, we detail the example of the
documentation of these functions, which uses the famous dataset of
native Human populations, HGDP:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hgdp</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## === gData object ===</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @coords: spatial coordinates of 52 nodes</span></span>
<span><span class="co">##   lon lat</span></span>
<span><span class="co">## 1  -3  59</span></span>
<span><span class="co">## 2  39  44</span></span>
<span><span class="co">## 3  40  61</span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @nodes.id: nodes identifiers</span></span>
<span><span class="co">##   28179   11012   22532 </span></span>
<span><span class="co">## "26898" "11652" "22532" </span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## @data: 52 data</span></span>
<span><span class="co">##   Population Region Label  n Latitude Longitude Genetic.Div</span></span>
<span><span class="co">## 1   Orcadian EUROPE     1 15       59        -3      0.7259</span></span>
<span><span class="co">## 2     Adygei EUROPE     2 17       44        39      0.7298</span></span>
<span><span class="co">## 3    Russian EUROPE     3 25       61        40      0.7320</span></span>
<span><span class="co">## ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Associated gGraph: worldgraph.40k</span></span></code></pre>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hgdp</span>, reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/unnamed-chunk-34-1.png" width="768"></p>
<p>Populations of the dataset are shown by red circles, while the
underlying grid (<code>worldgraph.40k</code>) is represented with colors
depending on habitat (blue: sea; green: land; pink: coasts). Population
genetics predicts that genetic diversity within populations should decay
as populations are located further away from the geographic origin of
the species. Here, we verify this relationship for a theoretical origin
in Addis abeba, Ethiopia. We shall seek all paths through landmasses to
the HGDP populations.</p>
<p>First, we check that all populations are connected on the grid using
<code>isConnected</code>:</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/graph-class.html" class="external-link">isConnected</a></span><span class="op">(</span><span class="va">hgdp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Note that in practice, we may often want to assess graphically the
connectivity of the underlying grid, especially if not all locations of
the <code>gData</code> are connected. This can be done using
<code>connectivityPlot</code>, which has methods for both
<code>gGraph</code> and <code>gData</code>, and represents different
connected components using different colors. For instance, for
<code>worldgraph.10k</code>:</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/connectivity.html">connectivityPlot</a></span><span class="op">(</span><span class="va">worldgraph.10k</span>, edges <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/connectivityPlot-1.png" width="768"></p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/zoom.html">geo.zoomin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">150</span>, <span class="fl">18</span>, <span class="op">-</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Different connected components\n in worldgraph.10k"</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/unnamed-chunk-36-1.png" width="700"></p>
<p>Since all locations in <code>hgdp</code> are connected, we can
proceed further. We have to set the costs of edges in the
<code>gGraph</code> grid. To do so, we can choose between i) strictly
uniform costs (using <code>dropCosts</code>) ii) distance-based costs –
roughly uniform – (using <code>setDistCosts</code>) or iii)
attribute-driven costs (using <code>setCosts</code>).</p>
<p>We shall first illustrate the strictly uniform costs. After setting a
<code>gGraph</code> with uniform costs, we use <code>dijkstraFrom</code>
to find the shortest paths between Addis abeba and the populations of
<code>hgdp</code>:</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myGraph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gGraph-class.html">dropCosts</a></span><span class="op">(</span><span class="va">worldgraph.40k</span><span class="op">)</span></span>
<span><span class="va">hgdp</span><span class="op">@</span><span class="va">gGraph.name</span> <span class="op">&lt;-</span> <span class="st">"myGraph"</span></span>
<span><span class="va">addis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">38</span>, <span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">ori</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/closestNode.html">closestNode</a></span><span class="op">(</span><span class="va">myGraph</span>, <span class="va">addis</span><span class="op">)</span></span>
<span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dijkstra-methods.html">dijkstraFrom</a></span><span class="op">(</span><span class="va">hgdp</span>, <span class="va">ori</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: RBGL</span></span></code></pre>
<p>The object <code>paths</code> contains the identified paths, which
are stored as a list with class <code>gPath</code> (see
<code><a href="../reference/dijkstra-methods.html">?gPath</a></code>). Paths can be plotted easily:</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">addis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">addis</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">myGraph</span>, col <span class="op">=</span> <span class="cn">NA</span>, reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">paths</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">addis</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">addis</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="st">"x"</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">addis</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">35</span>, <span class="va">addis</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">"Addis abeba"</span>, cex <span class="op">=</span> <span class="fl">.8</span>, font <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">hgdp</span>, col.node <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/unnamed-chunk-38-1.png" width="768"></p>
<p>In this graph, each path is plotted with a different color, but
several paths overlap in several places. We can extract the distances
from the
<code>origin' using</code>gPath2dist<code>, and then examine the relationship between genetic diversity within populations (stored in</code>hgdp`)
and the distance from the origin:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">div</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gData-class.html">getData</a></span><span class="op">(</span><span class="va">hgdp</span><span class="op">)</span><span class="op">$</span><span class="st">"Genetic.Div"</span></span>
<span><span class="va">dgeo.unif</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dijkstra-methods.html">gPath2dist</a></span><span class="op">(</span><span class="va">paths</span>, res.type <span class="op">=</span> <span class="st">"vector"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">div</span> <span class="op">~</span> <span class="va">dgeo.unif</span>, xlab <span class="op">=</span> <span class="st">"GeoGraphic distance (arbitrary units)"</span>, ylab <span class="op">=</span> <span class="st">"Genetic diversity"</span><span class="op">)</span></span>
<span><span class="va">lm.unif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">div</span> <span class="op">~</span> <span class="va">dgeo.unif</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">lm.unif</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm.unif</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = div ~ dgeo.unif)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.07327 -0.00660  0.00074  0.01015  0.05449 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  7.70e-01   4.58e-03   168.2   &lt;2e-16 ***</span></span>
<span><span class="co">## dgeo.unif   -8.39e-04   5.31e-05   -15.8   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.0185 on 50 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.833,  Adjusted R-squared:  0.83 </span></span>
<span><span class="co">## F-statistic:  250 on 1 and 50 DF,  p-value: &lt;2e-16</span></span></code></pre>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Genetic diversity vs geographic distance \n uniform costs "</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/unnamed-chunk-39-1.png" width="700"></p>
<p>Alternatively, we can use costs based on habitat. As a toy example,
we will consider that coasts are four times more favourable for
dispersal than the rest of the landmasses. We define these new costs,
and then compute and plot the corresponding shortest paths:</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myGraph</span><span class="op">@</span><span class="va">meta</span><span class="op">$</span><span class="va">costs</span><span class="op">[</span><span class="fl">7</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coast"</span>, <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="va">myGraph</span><span class="op">@</span><span class="va">meta</span><span class="op">$</span><span class="va">costs</span></span></code></pre></div>
<pre><code><span><span class="co">##            habitat cost</span></span>
<span><span class="co">## 1              sea  100</span></span>
<span><span class="co">## 2             land    1</span></span>
<span><span class="co">## 3         mountain   10</span></span>
<span><span class="co">## 4       landbridge    5</span></span>
<span><span class="co">## 5 oceanic crossing   20</span></span>
<span><span class="co">## 6  deselected land  100</span></span>
<span><span class="co">## 7            coast 0.25</span></span></code></pre>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myGraph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setCosts.html">setCosts</a></span><span class="op">(</span><span class="va">myGraph</span>, attr.name <span class="op">=</span> <span class="st">"habitat"</span><span class="op">)</span></span>
<span><span class="va">paths.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dijkstra-methods.html">dijkstraFrom</a></span><span class="op">(</span><span class="va">hgdp</span>, <span class="va">ori</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">newGraph</span>, col <span class="op">=</span> <span class="cn">NA</span>, reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">paths.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">addis</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">addis</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="st">"x"</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">addis</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">35</span>, <span class="va">addis</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">"Addis abeba"</span>, cex <span class="op">=</span> <span class="fl">.8</span>, font <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">hgdp</span>, col.node <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/unnamed-chunk-41-1.png" width="768"></p>
<p>The new paths are slightly different from the previous ones. We can
examine the new relationship with genetic distance:</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dgeo.hab</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dijkstra-methods.html">gPath2dist</a></span><span class="op">(</span><span class="va">paths.2</span>, res.type <span class="op">=</span> <span class="st">"vector"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">div</span> <span class="op">~</span> <span class="va">dgeo.hab</span>, xlab <span class="op">=</span> <span class="st">"GeoGraphic distance (arbitrary units)"</span>, ylab <span class="op">=</span> <span class="st">"Genetic diversity"</span><span class="op">)</span></span>
<span><span class="va">lm.hab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">div</span> <span class="op">~</span> <span class="va">dgeo.hab</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">lm.hab</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm.hab</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = div ~ dgeo.hab)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.11183 -0.00976  0.00133  0.01216  0.06413 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  0.770137   0.007174  107.36  &lt; 2e-16 ***</span></span>
<span><span class="co">## dgeo.hab    -0.001421   0.000145   -9.79  3.2e-13 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.0265 on 50 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.657,  Adjusted R-squared:  0.651 </span></span>
<span><span class="co">## F-statistic: 95.9 on 1 and 50 DF,  p-value: 3.21e-13</span></span></code></pre>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Genetic diversity vs geographic distance \n habitat costs "</span><span class="op">)</span></span></code></pre></div>
<p><img src="geograph_files/figure-html/unnamed-chunk-42-1.png" width="700"></p>
<p>Of course, the distinction between coasts and inner landmasses is a
somewhat poor description of habitat. In practice, complex habitat
models can be used as simply.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Andrea Manica.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
